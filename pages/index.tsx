
import type { InferGetStaticPropsType, NextPage } from 'next'
import Head from 'next/head'
import Image from 'next/image'
import style from '../components/Menu/Menu.module.css'
import {getAllProducts} from '../framework/product/getAllProducts'
import {getConfig} from '../framework/common/config'
import ProductCard from '@components/ProductCard/ProductCard'
import {createClient} from 'contentful'
import { homeProps } from '../framework/common/types/webpage'
import Topbar from '../components/TopBar/Topbar'
import Menu from '@components/Menu'
import Hero from '@components/Hero/Hero'


const Home: NextPage<homeProps> = ({topBar,menu,iconLibrary,products}) => {

  topBar.sort( (a,b) => {
    return a.fields.id - b.fields.id })
  menu.sort( (a,b) => {
    return a.fields.id- b.fields.id
  }

  
  )
  
  return (
   <>
      <Head>
        <title>Power force</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"></link>
      </Head>

      <main >
          
         <Topbar topItems={topBar} />  

         <div className=' bg-primary-100' >
          
          <Menu menu={menu} iconLibrary={iconLibrary} />
          
         <Hero/> 
          


         <ProductCard products={products}/>

         </div>
          
      </main>

      <footer >
        
      </footer>
    </>
  )
}



export async function getStaticProps() {
//  export async function getServerSideProps() {
  const client = createClient({
      space: process.env.CONTENTFUL_SPACE || '',
      accessToken: process.env.CONTENTFUL_ACCESS_TOKEN || ''
  })
  
  const topBar = await client.getEntries({
    'fields.visible': 'true',
    content_type: 'topBar',
  })
  const menu = await client.getEntries({
    'fields.visible': 'true',
    content_type: 'menu',
  })
  const iconLibrary = await client.getEntries({
    
    content_type: 'iconLibrary',
  })

const config = getConfig()
const products = await getAllProducts(config)


  return {
    props:{
      topBar: topBar.items,
      menu: menu.items,
      iconLibrary: iconLibrary.items,
      products: products
      
    }
  }
}

 




export default Home
